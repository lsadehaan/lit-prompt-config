<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>lit-prompt-config Demo</title>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'IBM Plex Sans', -apple-system, sans-serif;
      background: #f5f5f4;
      color: #1c1917;
      min-height: 100vh;
      padding: 24px;
    }
    @media (prefers-color-scheme: dark) {
      body { background: #0c0a09; color: #fafaf9; }
    }

    .demo-header {
      max-width: 1200px;
      margin: 0 auto 24px;
    }
    .demo-header h1 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .demo-header p {
      font-size: 14px;
      color: #78716c;
    }

    .demo-grid {
      display: grid;
      grid-template-columns: 350px 1fr;
      gap: 24px;
      max-width: 1200px;
      margin: 0 auto;
    }
    @media (max-width: 900px) {
      .demo-grid {
        grid-template-columns: 1fr;
      }
    }

    .demo-section h2 {
      font-size: 14px;
      font-weight: 600;
      color: #78716c;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .panel {
      background: #fff;
      border: 1px solid #d6d3d1;
      border-radius: 8px;
      overflow: hidden;
      margin-top: 16px;
    }
    @media (prefers-color-scheme: dark) {
      .panel { background: #1c1917; border-color: #44403c; }
    }

    .panel-header {
      padding: 10px 14px;
      font-weight: 600;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border-bottom: 1px solid #e7e5e4;
      color: #78716c;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    @media (prefers-color-scheme: dark) {
      .panel-header { border-color: #44403c; }
    }

    .panel-body {
      padding: 14px;
    }

    pre {
      font-family: 'IBM Plex Mono', monospace;
      font-size: 11px;
      line-height: 1.6;
      white-space: pre-wrap;
      word-break: break-all;
      max-height: 400px;
      overflow-y: auto;
      color: #57534e;
    }
    @media (prefers-color-scheme: dark) {
      pre { color: #d6d3d1; }
    }

    .event-log {
      max-height: 150px;
      overflow-y: auto;
    }
    .event-item {
      padding: 4px 0;
      border-bottom: 1px solid #f5f5f4;
      font-size: 11px;
    }
    @media (prefers-color-scheme: dark) {
      .event-item { border-color: #292524; }
    }
    .event-item .event-name {
      font-family: 'IBM Plex Mono', monospace;
      color: #d97706;
      font-weight: 500;
    }
    .event-item .event-time {
      color: #a8a29e;
      font-family: 'IBM Plex Mono', monospace;
      font-size: 10px;
    }

    .badge {
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 99px;
      background: #d97706;
      color: white;
      font-weight: 500;
    }

    .theme-btn.active {
      background: #d97706 !important;
      color: white !important;
      border-color: #d97706 !important;
    }
    @media (prefers-color-scheme: dark) {
      .theme-btn { color: #fafaf9; border-color: #44403c !important; }
    }
  </style>
</head>
<body>

  <div class="demo-header">
    <h1>&lt;prompt-config&gt;</h1>
    <p>LLM prompt management component - Models via OpenRouter</p>
    <div style="margin-top: 12px; display: flex; gap: 8px;">
      <button id="themeAuto" class="theme-btn active" style="padding: 4px 12px; font-size: 12px; border: 1px solid #d6d3d1; border-radius: 4px; background: transparent; cursor: pointer; font-family: inherit;">Auto</button>
      <button id="themeLight" class="theme-btn" style="padding: 4px 12px; font-size: 12px; border: 1px solid #d6d3d1; border-radius: 4px; background: transparent; cursor: pointer; font-family: inherit;">Light</button>
      <button id="themeDark" class="theme-btn" style="padding: 4px 12px; font-size: 12px; border: 1px solid #d6d3d1; border-radius: 4px; background: transparent; cursor: pointer; font-family: inherit;">Dark</button>
    </div>
  </div>

  <div class="demo-grid">
    <!-- Left: Card variant -->
    <div class="demo-section">
      <h2>Card Variant</h2>
      <prompt-config id="pc-card" variant="card" theme="auto"></prompt-config>

      <div class="panel">
        <div class="panel-header">
          Event Log
          <span class="badge" id="eventCount">0</span>
        </div>
        <div class="panel-body">
          <div class="event-log" id="eventLog">
            <div style="color:#a8a29e; font-size:11px;">Waiting for events...</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right: Full variant (or expanded card) -->
    <div class="demo-section">
      <h2>Full Variant</h2>
      <prompt-config id="pc-full" variant="full" theme="auto"></prompt-config>

      <div class="panel">
        <div class="panel-header">
          Live JSON Output
          <button id="copyBtn" style="font-size:10px; padding:2px 8px; border:1px solid #d6d3d1; border-radius:4px; background:transparent; cursor:pointer; color:inherit; font-family:inherit;">
            Copy
          </button>
        </div>
        <div class="panel-body">
          <pre id="jsonOutput">Loading...</pre>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import '../src/index.ts';

    const pcCard = document.getElementById('pc-card');
    const pcFull = document.getElementById('pc-full');
    const jsonOutput = document.getElementById('jsonOutput');
    const eventLog = document.getElementById('eventLog');
    const eventCount = document.getElementById('eventCount');
    const copyBtn = document.getElementById('copyBtn');
    let count = 0;

    // Shared initial value
    const initialValue = {
      id: 'demo-summarizer',
      name: 'Article Summarizer',
      description: 'Summarizes articles into key bullet points',
      provider: 'anthropic',
      model: '',
      systemPrompt: 'You are a concise article summarizer. Extract the key points and present them clearly.',
      userPromptTemplate: 'Please summarize the following article in {{num_sentences}} sentences:\n\n{{article_text}}',
      temperature: 0.7,
      maxTokens: 1024,
      topP: 1.0,
      topK: 0,
      frequencyPenalty: 0,
      presencePenalty: 0,
      repetitionPenalty: 1.0,
      minP: 0,
      stopSequences: [],
      responseFormat: 'text',
      jsonSchema: null,
      tools: [],
      toolChoice: 'auto',
      reasoning: false,
      reasoningEffort: 'medium',
      sampleInputs: {
        num_sentences: '3',
        article_text: 'Artificial intelligence continues to reshape industries worldwide. From healthcare diagnostics to autonomous vehicles, AI applications are expanding rapidly.'
      },
      metadata: {}
    };

    // Set initial values (both components share the same config)
    pcCard.value = { ...initialValue };
    pcFull.value = { ...initialValue };

    // Sync changes between components
    function syncConfig(source, target, config) {
      target.value = { ...config };
      updateJson(config);
    }

    function updateJson(config) {
      jsonOutput.textContent = JSON.stringify(config, null, 2);
    }
    updateJson(pcFull.value);

    // Listen to card events
    pcCard.addEventListener('prompt-change', (e) => {
      syncConfig(pcCard, pcFull, e.detail);
      logEvent('prompt-change', 'Card: Config updated');
    });

    // Listen to full events
    pcFull.addEventListener('prompt-change', (e) => {
      syncConfig(pcFull, pcCard, e.detail);
      logEvent('prompt-change', 'Full: Config updated');
    });

    // Test handlers
    [pcCard, pcFull].forEach(pc => {
      pc.addEventListener('prompt-save', (e) => {
        logEvent('prompt-save', 'Save requested');
      });

      pc.addEventListener('prompt-test', async (e) => {
        logEvent('prompt-test', `Testing: ${e.detail.config.model || 'no model'}`);
        pc.setTestLoading(true);

        await new Promise(r => setTimeout(r, 1500));

        pc.setTestResult(
          'Simulated response.\n\nPayload:\n' +
          JSON.stringify(e.detail.payload, null, 2)
        );
      });
    });

    function logEvent(name, detail) {
      count++;
      eventCount.textContent = count;
      const time = new Date().toLocaleTimeString();
      const item = document.createElement('div');
      item.className = 'event-item';
      item.innerHTML = `<span class="event-time">${time}</span> <span class="event-name">${name}</span> - ${detail}`;
      if (eventLog.children[0]?.textContent?.includes('Waiting')) {
        eventLog.innerHTML = '';
      }
      eventLog.prepend(item);
    }

    // Copy button
    copyBtn.addEventListener('click', () => {
      navigator.clipboard.writeText(jsonOutput.textContent);
      copyBtn.textContent = 'Copied!';
      setTimeout(() => copyBtn.textContent = 'Copy', 1500);
    });

    // Theme switching
    const themeAuto = document.getElementById('themeAuto');
    const themeLight = document.getElementById('themeLight');
    const themeDark = document.getElementById('themeDark');
    const themeBtns = [themeAuto, themeLight, themeDark];

    function setTheme(theme) {
      pcCard.setAttribute('theme', theme);
      pcFull.setAttribute('theme', theme);
      themeBtns.forEach(btn => btn.classList.remove('active'));
      if (theme === 'auto') themeAuto.classList.add('active');
      if (theme === 'light') themeLight.classList.add('active');
      if (theme === 'dark') themeDark.classList.add('active');
      logEvent('theme-change', `Theme set to: ${theme}`);
    }

    themeAuto.addEventListener('click', () => setTheme('auto'));
    themeLight.addEventListener('click', () => setTheme('light'));
    themeDark.addEventListener('click', () => setTheme('dark'));
  </script>
</body>
</html>
